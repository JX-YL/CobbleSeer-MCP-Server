# 游戏内文本换行指南

## 📖 原理说明

Minecraft/Cobblemon 的文本显示系统会在**空格处**自动换行，而不是强制在标点处换行。

空格作为"软换行点"，游戏根据显示宽度自动选择在哪个空格处换行。

## 🎯 参考文件示例

```json
// 示例1：多个软换行点
"用一闪而过的速度 交换自己和对手的持有物。"
                   ↑ 软换行点

// 示例2：标点+句中都有空格
"用坚硬的尾巴 拍打对手进行攻击。 连续攻击2～5次。"
             ↑                    ↑ 两个软换行点

// 示例3：更多断点
"刮起猛烈的旋风， 在4回合内 提高我方全员的速度。"
               ↑          ↑ 多个断点供选择
```

## 🔧 CobbleSeer 的实现

### 自动处理
Builder 会自动添加基础的软换行点：

1. **标点符号后**：`。` `，` `！` `？` `；` `：`
2. **常见词后**：`攻击` `进行` `提高` `降低` `回复` `给予` `对手` `自己` 等

### 示例效果
```
原文：用电击攻击对手。有时会让对手陷入麻痹状态。
处理后：用电击 攻击 对手。 有时会让对手 陷入麻痹状态。
```

## ⚙️ 三种使用方式

### 方式1：使用默认（最简单）✅
```python
# Builder 自动处理
builder = Builder(config)
files = builder.build_all(pokemon_data)
# 语言文件已包含基础的软换行点
```

**适用**：快速生成，接受自动格式化结果

### 方式2：手动精细调整（最佳效果）⭐
生成后手动编辑语言文件，在关键位置添加空格：

```json
{
  "cobblemon.move.testthundershock.desc": "用电击攻击对手。 有时会让对手陷入麻痹状态。"
}
```

调整为：
```json
{
  "cobblemon.move.testthundershock.desc": "用电击 攻击 对手。 有时会让对手 陷入麻痹状态。"
}
```

**添加空格的位置建议**：
- 动词前后：`...身体 撞向对手...`
- 介词前：`...旋风， 在4回合内...`
- 短语之间：`...速度 交换自己...`

### 方式3：禁用自动格式化
如果不想自动添加空格，可以修改代码跳过格式化。

## 📝 最佳实践

### 1. 测试循环
```
生成数据包 → 进入游戏测试 → 查看显示效果 → 调整空格位置 → 重新测试
```

### 2. 空格位置原则
- **短句**（<15字）：只在标点后加空格
- **中句**（15-30字）：在标点和1-2个关键位置加空格  
- **长句**（>30字）：多加几个空格，每10-15字一个

### 3. 避免过度
```
❌ 太多空格：用 电击 攻击 对手。 有时 会让 对手 陷入 麻痹 状态。
✅ 适度空格：用电击 攻击 对手。 有时会让对手 陷入麻痹状态。
```

## 🎮 游戏内测试

1. 将数据包放入 `datapacks/` 文件夹
2. 执行 `/reload`
3. 召唤宝可梦，查看技能描述
4. 检查文本是否正常换行、是否被截断
5. 根据效果调整空格位置

## 💡 提示

- **英文**：标点后用**双空格**（`.  `）
- **中文**：标点后用**单空格**（`。 `）
- **数字/英文缩写**：前后可以不加空格（如 `2～5次`、`HP`）

## 🔗 相关文件

- `services/builder.py` - Builder 实现
- `test_improved_formatting.py` - 格式化测试
- 参考：`Reference document/Cobblemon/语言参考/lang/zh_cn.json`

---

**总结**：CobbleSeer 提供基础的自动格式化，但最佳效果需要根据游戏内显示手动调整。

**制作者**：江下犹泷  
**日期**：2025-01-19

